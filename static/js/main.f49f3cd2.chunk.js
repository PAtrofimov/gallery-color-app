(this.webpackJsonptemplate_redux_js=this.webpackJsonptemplate_redux_js||[]).push([[0],{104:function(e,t,n){},206:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(44),o=n.n(a),i=n(13),s=n(15),l=n(30),u=n(86),d=n(3),j=n(4),O="galleryState",b=function(){function e(){Object(d.a)(this,e)}return Object(j.a)(e,null,[{key:"get",value:function(){return JSON.parse(sessionStorage.getItem(O))}},{key:"set",value:function(e){sessionStorage.setItem(O,JSON.stringify(e))}}]),e}(),h="SET_COLORS",m="SET_ISLOADING",p="SET_ERROR",f="ADD_COLOR",x="EDIT_COLOR",g="REMOVE_COLOR",v="SET_RATING",y=function(e){var t=e.getState;return function(e){return function(n){var r=e(n);return[h,p,m].includes(n.type)||(b.set(t()),console.log("store ",{store:t(),action:n})),r}}},N=n(8),C=n(2),_={colors:[],isLoading:!1,error:""};var R="SET_ADMIN",L={isAdmin:!1};var S={color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(C.a)(Object(C.a)({},e),{},{colors:t.payload});case m:return Object(C.a)(Object(C.a)({},e),{},{isLoading:t.payload});case p:return Object(C.a)(Object(C.a)({},e),{},{error:t.payload,isLoading:!1});case f:return Object(C.a)(Object(C.a)({},e),{},{colors:[].concat(Object(N.a)(e.colors),[Object(C.a)(Object(C.a)({},t.payload),{},{id:String(Date.now())})])});case x:var n=t.payload,r=n.id,c=n.name,a=n.description,o=n.color,i=n.rate,s=e.colors.map((function(e){if(e.id===r){var t=e.rating||[];return t=i?[].concat(Object(N.a)(t),[i]):t,Object(C.a)(Object(C.a)({},e),{},{name:c,description:a,color:o,rating:t})}return e}));return Object(C.a)(Object(C.a)({},e),{},{colors:s});case g:return Object(C.a)(Object(C.a)({},e),{},{colors:e.colors.filter((function(e){return e.id!==t.payload}))});case v:var l=t.payload,u=l.id,d=l.rate,j=e.colors.map((function(t){return t.id===u?Object(C.a)(Object(C.a)({},t),{},{rating:[].concat(Object(N.a)(e.colors.rating),[d])}):t}));return Object(C.a)(Object(C.a)({},e),{},{colors:j});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;return t.type===R?Object(C.a)(Object(C.a)({},e),{},{isAdmin:t.payload}):e}},k=Object(l.c)(S),w=Object(l.d)(k,Object(l.a)(u.a,y)),D=(n(103),n(104),n(6)),A=n(1),I=function(){return Object(A.jsx)("header",{className:"header",children:Object(A.jsx)("h1",{className:"header__title",children:Object(A.jsx)("a",{href:"/",className:"header__logo",children:"Colors Gallery"})})})},E=function(){return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",{type:"checkbox",id:"nav-toggle",hidden:!0}),Object(A.jsxs)("nav",{className:"nav",children:[Object(A.jsx)("label",{htmlFor:"nav-toggle",className:"nav-toggle"}),Object(A.jsx)("h2",{children:"Menu"}),Object(A.jsxs)("ul",{children:[Object(A.jsx)("li",{children:Object(A.jsx)(s.c,{to:"/",activeClassName:"active",children:"Colors list"})}),Object(A.jsx)("li",{children:Object(A.jsx)(s.c,{to:"/add",activeClassName:"active",children:"Add color"})})]})]})]})},T=function(e){var t=e.children;return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(I,{}),Object(A.jsx)(E,{}),Object(A.jsx)("main",{role:"main",children:t})]})},B=n(45),M=n(36),P=n(24),F=n.n(P),U=[{id:"1",name:"yellow",description:"",color:"#ffff00",rating:[3,4,5]},{id:"2",name:"red",description:"",color:"#ff0000",rating:[2,1,2]},{id:"3",name:"green",description:"",color:"#008000",rating:[3,2,1]}],q=function(){function e(){Object(d.a)(this,e)}return Object(j.a)(e,null,[{key:"get",value:function(){var e=Object(M.a)(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout((function(){return e(U)}),200)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),G={setColors:function(e){return{type:h,payload:e}},setError:function(e){return{type:p,payload:e}},setIsLoading:function(e){return{type:m,payload:e}},addColor:function(e){return{type:f,payload:e}},editColor:function(e){return{type:x,payload:e}},removeColor:function(e){return{type:g,payload:e}},setRating:function(e){return{type:v,payload:e}},fetchColors:function(){return function(){var e=Object(M.a)(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(G.setIsLoading(!0)),setTimeout(Object(M.a)(F.a.mark((function e(){var n,r,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=b.get(),(c=null===r||void 0===r||null===(n=r.color)||void 0===n?void 0:n.colors)&&0!==c.length){e.next=10;break}return e.next=6,q.get();case 6:c=e.sent,console.log("colors not from cash",{colors:c}),e.next=11;break;case 10:console.log("colors from cash",{colors:c});case 11:t(G.setColors(c)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),t(G.setError("Error occurs when loading"));case 17:return e.prev=17,t(G.setIsLoading(!1)),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])}))),3e3);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},J={setIsAdmin:function(e){return{type:R,payload:e}}},H=Object(C.a)(Object(C.a)({},G),J);var V=function(){var e=Object(i.b)();return Object(l.b)(H,e)},z=n(94),K=n(37),Q=K.a().shape({name:K.b().min(5,"Name is too short (>5)!").required("Required"),description:K.b().min(10,"Description is too short (>10)!").max(300,"Description is too long(<300)!"),color:K.b().required("Color is required")}),W=function(){var e=Object(D.useHistory)(),t=V().addColor,n=Object(z.a)({initialValues:{name:"",description:"",color:""},validationSchema:Q,onSubmit:function(e,n){t(e),n.resetForm()}});return Object(A.jsxs)("section",{className:"gallery-create",children:[Object(A.jsx)("header",{className:"gallery-create__header",children:Object(A.jsx)("h2",{children:"Add color"})}),Object(A.jsxs)("form",{onSubmit:n.handleSubmit,className:"gallery-create__container",children:[Object(A.jsxs)("label",{className:"form-line",children:[Object(A.jsx)("span",{children:"Name:"}),Object(A.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:n.values.name,onChange:n.handleChange,onBlur:n.handleBlur})]}),n.touched.name&&n.errors.name?Object(A.jsx)("div",{className:"error",children:n.errors.name}):null,Object(A.jsxs)("div",{className:"form-line",children:[Object(A.jsx)("span",{children:"Description:"}),Object(A.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:n.values.description,onChange:n.handleChange,onBlur:n.handleBlur})]}),n.touched.description&&n.errors.description?Object(A.jsx)("div",{className:"error",children:n.errors.description}):null,Object(A.jsxs)("label",{className:"form-line",children:[Object(A.jsx)("span",{children:"Choose color:"}),Object(A.jsx)("input",{type:"color",name:"color",className:"form-input",value:n.values.color,onChange:n.handleChange,onBlur:n.handleBlur})]}),n.touched.color&&n.errors.color?Object(A.jsx)("div",{className:"error",children:n.errors.color}):null,Object(A.jsxs)("div",{className:"items__actions",children:[Object(A.jsx)("button",{type:"submit",children:"Add"}),Object(A.jsx)("button",{type:"button",onClick:function(t){e.push(me.COLORS)},children:"Close"})]})]})]})},X=n(29),Y=n(31);function Z(e){var t=null===e||void 0===e?void 0:e.length,n=0;return t&&(n=Math.round(e.reduce((function(e,t){return e+t}))/t)),n}function $(e){return new Array(e).fill(0).map((function(e,t){return t+1})).reverse()}var ee=function(e){return e.color.colors},te=Object(Y.a)([ee],(function(e){return e.reduce((function(e,t){return Object(C.a)(Object(C.a)({},e),{},Object(X.a)({},t.id,t))}),{})})),ne=Object(Y.a)([te,function(e,t){return t}],(function(e,t){return e[t]})),re=(Object(Y.a)(ee,(function(e){return e.map((function(e){var t=Z(null===e||void 0===e?void 0:e.rating);return Object(C.a)(Object(C.a)({},e),{},{averageRating:t})}))})),Object(Y.a)(ee,(function(e){return e.map((function(e){return e.id}))}))),ce=Object(Y.a)(ne,(function(e){var t=Z(null===e||void 0===e?void 0:e.rating);return Object(C.a)(Object(C.a)({},e),{},{averageRating:t})})),ae=function(e){var t=e.id,n=e.value,r=e.disabled,c=e.averageRating,a=e.onChange,o="star-".concat(t,"-").concat(n),i="rating".concat(t),s="Rating \xab".concat(n,"\xbb");return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",{type:"radio",id:o,name:i,value:n,onChange:function(){a(n)},disabled:r,checked:c===n}),Object(A.jsx)("label",{htmlFor:o,title:s})]})};ae.defaultProps={disabled:!1,onChange:function(){}};var oe=ae,ie=n(49),se=n.n(ie),le=function(e){var t=e.className,n=e.averageRating,r=e.children,a=c.a.Children.count(r),o="".concat(n," of ").concat(a," stars");return Object(A.jsxs)("div",{className:"item__rating",children:[Object(A.jsx)("div",{className:se()(t,"stars"),children:r}),Object(A.jsx)("div",{className:"items__stars-value",children:o})]})},ue=function(e){var t=e.id,n=Object(i.c)((function(e){return e.user.isAdmin})),r=Object(i.c)((function(e){return ce(e,t)})),c=r.color,a=r.name,o=r.averageRating,s=Object(B.useHistory)();return Object(A.jsx)("article",{className:"gallery__col",children:Object(A.jsxs)("div",{className:"gallery__item item",onClick:function(e){e.stopPropagation(),n?s.push("/color/".concat(t,"?role=admin")):s.push("/color/".concat(t))},children:[Object(A.jsx)("div",{className:"item__name","data-name":a,style:{color:c},children:a}),Object(A.jsx)("div",{className:"item__color-block",style:{background:c}}),Object(A.jsx)(le,{className:"item__stars",averageRating:o,onClick:function(e){e.stopPropagation()},children:$(5).map((function(e){return Object(A.jsx)(oe,{value:e,disabled:!0,averageRating:o,id:t},e)}))})]})})},de=function(){var e=V().setIsAdmin,t=Object(i.c)((function(e){return e.user.isAdmin})),n=Object(i.c)((function(e){return e.color})),r=n.isLoading,c=n.error,a=Object(i.c)(re);return Object(A.jsxs)("section",{className:"gallery",children:[Object(A.jsx)("header",{className:"gallery__header",children:Object(A.jsx)("h2",{children:"Colors list"})}),Object(A.jsx)("button",{onClick:function(){e(!t)},style:{marginRight:"auto",marginBottom:"20px"},children:t?"Try User":"Try Admin"}),r?Object(A.jsx)("div",{children:"Loading ..."}):c?Object(A.jsx)("div",{children:"Some error appears. Reload please!"}):Object(A.jsx)("div",{className:"gallery__row",children:a.map((function(e){return Object(A.jsx)(ue,{id:e},e)}))})]})},je=function(){return Object(A.jsxs)("section",{className:"error-page",children:[Object(A.jsx)("header",{className:"gallery-create__header",children:Object(A.jsx)("h2",{children:"Unknown page"})}),Object(A.jsx)("h2",{children:"Unknown page"}),Object(A.jsx)(s.b,{to:"/",children:"Go to the main page"})]})},Oe=n(22),be={name:"",description:"",color:"",rate:""},he=function(){var e="admin"===function(){var e=Object(B.useLocation)().search;return Object(r.useMemo)((function(){return new URLSearchParams(e)}),[e])}().get("role"),t=Object(D.useParams)().id,n=Object(i.c)((function(e){return ce(e,t)})),c=Object(r.useState)(Object(C.a)(Object(C.a)({},be),n)),a=Object(Oe.a)(c,2),o=a[0],s=a[1],l=Object(D.useHistory)(),u=V(),d=u.editColor,j=u.removeColor,O=(u.setRating,function(e){var t=e.target,n=t.name,r=t.value;s((function(e){return Object(C.a)(Object(C.a)({},e),{},Object(X.a)({},n,r))}))}),b=function(e){s((function(t){return Object(C.a)(Object(C.a)({},t),{},{rate:e})}))};return Object(A.jsxs)("section",{className:"gallery-update gallery-update__container",children:[Object(A.jsx)("header",{className:"gallery-update__header",children:Object(A.jsx)("h2",{children:"Update color"})}),Object(A.jsxs)("form",{className:"gallery-create gallery-create__container",onSubmit:function(e){e.preventDefault(),d(o)},children:[Object(A.jsxs)("label",{className:"form-line",children:[Object(A.jsx)("span",{children:"Name:"}),Object(A.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:o.name,onChange:O})]}),Object(A.jsxs)("div",{className:"form-line",children:[Object(A.jsx)("span",{children:"Description:"}),Object(A.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:o.description,onChange:O})]}),Object(A.jsxs)("label",{className:"form-line",children:[Object(A.jsx)("span",{children:"Choose color:"}),Object(A.jsx)("input",{type:"color",name:"color",className:"form-input",value:o.color,onChange:O})]}),Object(A.jsx)(le,{className:"item__stars",averageRating:o.averageRating,onClick:function(e){e.stopPropagation()},children:$(5).map((function(n){return Object(A.jsx)(oe,{value:n,averageRating:e?o.averageRating:o.rate,onChange:b,disabled:e,id:t},n)}))}),Object(A.jsxs)("div",{className:"items__actions",children:[Object(A.jsx)("button",{type:"submit",children:"Save"}),Object(A.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),window.confirm("The color will be removed. Continue ?")&&j(t),l.push(me.COLORS)},className:se()({hidden:!e}),children:"Delete"}),Object(A.jsx)("button",{type:"button",onClick:function(e){l.push(me.COLORS)},children:"Close"})]})]})]})},me={COLORADMIN:"/color/:id?role=admin",COLOR:"/color/:id",COLORS:"/",ADDCOLOR:"/add"},pe=function(){return Object(A.jsx)(T,{children:Object(A.jsx)("div",{className:"content",children:Object(A.jsx)(he,{})})})},fe=[{id:me.COLORS,path:me.COLORS,render:function(){return Object(A.jsx)(T,{children:Object(A.jsx)("div",{className:"content",children:Object(A.jsx)(de,{})})})},exact:!0},{id:me.COLOR,path:me.COLOR,render:pe,exact:!0},{id:me.COLORADMIN,path:me.COLORADMIN,render:pe,exact:!0},{id:me.ADDCOLOR,path:me.ADDCOLOR,render:function(){return Object(A.jsx)(T,{children:Object(A.jsx)("div",{className:"content",children:Object(A.jsx)(W,{})})})},exact:!0},{id:"/error",render:function(){return Object(A.jsx)(T,{children:Object(A.jsx)("div",{className:"content",children:Object(A.jsx)(je,{})})})},exact:!0}],xe=function(){return Object(A.jsxs)(D.Switch,{children:[fe.map((function(e){return Object(r.createElement)(D.Route,Object(C.a)(Object(C.a)({},e),{},{key:e.id}))})),Object(A.jsx)(D.Redirect,{to:me.COLORS})]})};var ge=function(){return Object(A.jsx)("div",{className:"App",children:Object(A.jsx)(xe,{})})};w.dispatch(H.fetchColors()),o.a.render(Object(A.jsx)(i.a,{store:w,children:Object(A.jsx)(s.a,{children:Object(A.jsx)(ge,{})})}),document.getElementById("root"))}},[[206,1,2]]]);
//# sourceMappingURL=main.f49f3cd2.chunk.js.map