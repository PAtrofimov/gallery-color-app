(this.webpackJsonptemplate_redux_js=this.webpackJsonptemplate_redux_js||[]).push([[0],{54:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(22),o=n.n(a),s=n(9),i=n(10),l=n(15),u=n(43),j=n(23),d=n(24),O="galleryState",b=function(){function e(){Object(j.a)(this,e)}return Object(d.a)(e,null,[{key:"get",value:function(){return JSON.parse(sessionStorage.getItem(O))}},{key:"set",value:function(e){sessionStorage.setItem(O,JSON.stringify(e))}}]),e}(),h=function(e){var t=e.getState;return function(e){return function(n){var c=e(n);return b.set(t()),console.log({state:t()}),c}}},m=n(30),f=n(2),p="SET_COLORS",v="SET_ISLOADING",x="SET_ERROR",g="ADD_COLOR",y="EDIT_COLOR",C="REMOVE_COLOR",N="SET_RATING",_={colors:[],isLoading:!1,error:""};var R="SET_ADMIN",L={isAdmin:!1};var S={color:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case p:return Object(f.a)(Object(f.a)({},t),{},{colors:n.payload});case v:return Object(f.a)(Object(f.a)({},t),{},{isLoading:n.payload});case x:return Object(f.a)(Object(f.a)({},t),{},{error:n.payload,isLoading:!1});case g:return Object(f.a)(Object(f.a)({},t),{},{colors:[].concat(Object(m.a)(t.colors),[Object(f.a)(Object(f.a)({},n.payload),{},{id:Date.now()})])});case y:var c=n.payload,r=c.id,a=c.text,o=c.description,s=c.rate,i=s?[].concat(Object(m.a)(t.colors.rating),[s]):t.colors.rating,l=t.colors.filter((function(e){return e.id===r?Object(f.a)(Object(f.a)({},e),{},{text:a,description:o,rating:i}):e}));return Object(f.a)(Object(f.a)({},t),{},{colors:l});case C:var u=n.payload.id;return Object(f.a)(Object(f.a)({},t),{},{colors:t.colors.filter((function(e){return e.id!==u}))});case N:var j=n.payload,d=j.id,O=j.rate,b=t.colors.filter((function(t){return t.id===d?Object(f.a)(Object(f.a)({},t),{},{rating:[].concat(Object(m.a)(e.state.ratings),[O])}):t}));return Object(f.a)(Object(f.a)({},t),{},{colors:b});default:return t}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;return t.type===R?Object(f.a)(Object(f.a)({},e),{},{isAdmin:t.payload}):e}},k=Object(l.c)(S),A=Object(l.d)(k,Object(l.a)(u.a,h)),D=(n(54),n(3)),w=n(0),I=function(){return Object(w.jsx)("header",{className:"header",children:Object(w.jsx)("h1",{className:"header__title",children:Object(w.jsx)("a",{href:"/",className:"header__logo",children:"Colors Gallery"})})})},E=function(){return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{type:"checkbox",id:"nav-toggle",hidden:!0}),Object(w.jsxs)("nav",{className:"nav",children:[Object(w.jsx)("label",{htmlFor:"nav-toggle",className:"nav-toggle"}),Object(w.jsx)("h2",{children:"Menu"}),Object(w.jsxs)("ul",{children:[Object(w.jsx)("li",{children:Object(w.jsx)(i.c,{to:"/",activeClassName:"active",children:"Colors list"})}),Object(w.jsx)("li",{children:Object(w.jsx)(i.c,{to:"/add",activeClassName:"active",children:"Add color"})})]})]})]})},T=function(e){var t=e.children;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(I,{}),Object(w.jsxs)("div",{children:[Object(w.jsx)(E,{}),t]})]})},M=n(13),F=n(29),J=n(27),P=n(14),G=n.n(P),H=n(26),U=n(45),B=n.n(U),V=function(){function e(){Object(j.a)(this,e)}return Object(d.a)(e,null,[{key:"get",value:function(){var e=Object(H.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("./colors.json");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),q={setColors:function(e){return{type:p,payload:e}},setError:function(e){return{type:x,payload:e}},setIsLoading:function(e){return{type:v,payload:e}},addColor:function(e){return{type:g,payload:e}},editColor:function(e){return{type:y,payload:e}},removeColor:function(e){return{type:C,payload:e}},setRating:function(e){return{type:N,payload:e}},fetchColors:function(){return function(){var e=Object(H.a)(G.a.mark((function e(t){var n,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(q.setIsLoading(!0)),b.get(),e.next=5,V.get();case 5:c=e.sent,n=c.data,console.log("color",{colors:n}),t(q.setColors(n)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),t(q.setError(e.t0.message));case 14:return e.prev=14,t(q.setIsLoading(!1)),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})));return function(t){return e.apply(this,arguments)}}()}},z={setIsAdmin:function(e){return{type:R,payload:e}}},K=Object(f.a)(Object(f.a)({},q),z);var Q=function(){var e=Object(s.b)();return Object(l.b)(K,e)},W={name:"",description:"",color:""},X=function(){var e=Object(c.useState)(W),t=Object(F.a)(e,2),n=t[0],r=t[1],a=Object(D.useHistory)(),o=Q().addColor,s=function(e){var t=e.target,n=t.name,c=t.value;r((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(M.a)({},n,c))}))};return Object(w.jsxs)("form",{className:"gallery-create gallery-create__container",onSubmit:function(e){e.preventDefault(),o(n),r(W)},children:[Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Name:"}),Object(w.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:n.name,onChange:s})]}),Object(w.jsxs)("div",{className:"form-line",children:[Object(w.jsx)("span",{children:"Description:"}),Object(w.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:n.description,onChange:s})]}),Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Choose color:"}),Object(w.jsx)("input",{type:"color",name:"color",className:"form-input",value:n.color,onChange:s})]}),Object(w.jsxs)("div",{className:"items__actions",children:[Object(w.jsx)("button",{type:"submit",children:"Add"}),Object(w.jsx)("button",{onClick:function(e){a.push(be.COLORS)},children:"Close"})]})]})},Y=n(19);function Z(e){var t=0;return(null===e||void 0===e?void 0:e.length)&&(t=e.reduce((function(e,t){return e+t}))),t}function $(e){return new Array(e).fill(0).map((function(e,t){return t+1})).reverse()}var ee=function(e){return console.log({state2:e}),e.color.colors},te=Object(Y.a)([ee,function(e,t){return t}],(function(e,t){return e.find((function(e){return e.id===t}))})),ne=(Object(Y.a)(ee,(function(e){return e.map((function(e){var t=Z(null===e||void 0===e?void 0:e.rating);return Object(f.a)(Object(f.a)({},e),{},{averageRating:t})}))})),Object(Y.a)(ee,(function(e){return console.log({colors:e}),e.map((function(e){return e.id}))}))),ce=Object(Y.a)(te,(function(e){console.log({color:e});var t=Z(null===e||void 0===e?void 0:e.rating);return Object(f.a)(Object(f.a)({},e),{},{averageRating:t})})),re=function(e){var t=e.averageRating,n=e.children,c=r.a.Children.count(n),a="".concat(t," of ").concat(c," stars");return Object(w.jsxs)("div",{className:"item__rating",children:[n,Object(w.jsx)("div",{className:"items__stars-value",children:a})]})},ae=function(e){var t=e.value,n=e.disabled,c=e.onChange,r="star-".concat(t),a="Rating \xab".concat(t,"\xbb");return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{type:"radio",id:r,name:"rating",value:t,onChange:function(){c(t)},disabled:n}),Object(w.jsx)("label",{htmlFor:r,title:a})]})};ae.defaultProps={disabled:!1,onChange:function(){}};var oe=ae,se=n(28),ie=n.n(se),le=function(e){var t=e.className,n=e.children;return Object(w.jsx)("div",{className:ie()(t,"stars"),children:n})},ue=function(e){var t=e.id,n=Object(s.c)((function(e){return e.user.isAdmin})),c=Object(s.c)((function(e){return ce(e,t)})),r=c.color,a=c.name,o=c.averageRating,i=Object(J.useHistory)();return Object(w.jsxs)("div",{className:"gallery__item item",onClick:function(e){console.log("click"),n?i.push(be.COLORADMIN):i.push(be.COLOR)},children:[Object(w.jsx)("div",{className:"item__name",style:{color:r},children:a}),Object(w.jsx)("div",{className:"item__color-block",style:{background:r}}),Object(w.jsx)(re,{averageRating:o,onClick:function(e){e.stopPropagation()},children:Object(w.jsx)(le,{className:"item__stars",children:$(5).map((function(e){return Object(w.jsx)(oe,{value:e,disabled:!0},e)}))})})]})},je=function(){var e=Q(),t=e.fetchColors,n=e.setIsAdmin,r=Object(s.c)((function(e){return e.user.isAdmin}));Object(c.useEffect)((function(){t()}),[]);var a=Object(s.c)(ne);return Object(w.jsxs)("main",{role:"main",children:[Object(w.jsxs)("section",{className:"gallery",children:[Object(w.jsx)("header",{className:"gallery__header",children:Object(w.jsx)("h2",{children:"Colors list"})}),Object(w.jsx)("div",{className:"gallery__row",children:a.map((function(e){return Object(w.jsx)(ue,{id:e},e)}))}),Object(w.jsx)("button",{onClick:function(){n(!r)},children:r?"Try User":"Try Admin"})]}),"|"]})},de={name:"",description:"",color:"",rate:""},Oe=function(e){var t=e.id,n="admin"===function(){var e=Object(J.useLocation)().search;return Object(c.useMemo)((function(){return new URLSearchParams(e)}),[e])}().get("role"),r=Object(s.c)((function(e){return ce(e,t)})),a=Object(c.useState)(Object(f.a)(Object(f.a)({},de),r)),o=Object(F.a)(a,2),i=o[0],l=o[1],u=Object(D.useHistory)(),j=Q(),d=j.editColor,O=j.removeColor,b=function(e){var t=e.target,n=t.name,c=t.value;l((function(e){return Object(f.a)(Object(f.a)({},e),{},Object(M.a)({},n,c))}))},h=function(e){console.log(e),l((function(t){return Object(f.a)(Object(f.a)({},t),{},{rate:[e]})}))};return Object(w.jsxs)("form",{className:"gallery-create gallery-create__container",onSubmit:function(e){e.preventDefault(),d(i)},children:[Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Name:"}),Object(w.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:i.name,onChange:b})]}),Object(w.jsxs)("div",{className:"form-line",children:[Object(w.jsx)("span",{children:"Description:"}),Object(w.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:i.description,onChange:b})]}),Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Choose color:"}),Object(w.jsx)("input",{type:"color",name:"color",className:"form-input",value:i.color,onChange:b})]}),Object(w.jsx)(re,{averageRating:i.averageRating,onClick:function(e){e.stopPropagation()},children:Object(w.jsx)(le,{className:"item__stars",children:$(5).map((function(e){return Object(w.jsx)(oe,{value:e,onChange:h,disabled:n},e)}))})}),Object(w.jsxs)("div",{className:"items__actions",children:[Object(w.jsx)("button",{type:"submit",children:"Save"}),Object(w.jsx)("button",{onClick:function(e){window.confirm("The color will be removed. Continue ?")&&O(t),u.push(be.COLORS)},className:ie()({hide:!n}),children:"Delete"}),Object(w.jsx)("button",{onClick:function(e){u.push(be.COLORS)},children:"Close"})]})]})},be={COLORADMIN:"/color/:id?role=admin",COLOR:"/color/:id",COLORS:"/",ADDCOLOR:"/add"},he=function(){return Object(w.jsx)(T,{children:Object(w.jsx)(Oe,{})})},me=[{path:be.COLORS,render:function(){return Object(w.jsx)(T,{children:Object(w.jsx)(je,{})})},exact:!0},{path:be.COLOR,render:he,exact:!0},{path:be.COLORADMIN,render:he,exact:!0},{path:be.ADDCOLOR,render:function(){return Object(w.jsx)(T,{children:Object(w.jsx)(X,{})})},exact:!0}],fe=function(){return Object(w.jsxs)(D.Switch,{children:[me.map((function(e){return Object(c.createElement)(D.Route,Object(f.a)(Object(f.a)({},e),{},{key:e.path}))})),Object(w.jsx)(D.Redirect,{to:be.COLORS})]})};var pe=function(){return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(fe,{})})};o.a.render(Object(w.jsx)(s.a,{store:A,children:Object(w.jsx)(i.a,{children:Object(w.jsx)(pe,{})})}),document.getElementById("root"))}},[[77,1,2]]]);
//# sourceMappingURL=main.5539dfb8.chunk.js.map