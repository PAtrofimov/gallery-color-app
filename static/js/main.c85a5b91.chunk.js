(this.webpackJsonptemplate_redux_js=this.webpackJsonptemplate_redux_js||[]).push([[0],{104:function(e,t,n){},206:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(43),o=n.n(a),i=n(14),s=n(15),l=n(29),u=n(86),d=n(3),j=n(4),O="galleryState",b=function(){function e(){Object(d.a)(this,e)}return Object(j.a)(e,null,[{key:"get",value:function(){return JSON.parse(sessionStorage.getItem(O))}},{key:"set",value:function(e){sessionStorage.setItem(O,JSON.stringify(e))}}]),e}(),m="SET_COLORS",h="SET_ISLOADING",p="SET_ERROR",f="ADD_COLOR",v="EDIT_COLOR",g="REMOVE_COLOR",x="SET_RATING",y=function(e){var t=e.getState;return function(e){return function(n){var r=e(n);return[m,p,h].includes(n.type)||b.set(t()),r}}},C=n(8),N=n(2),R={colors:[],isLoading:!1,error:""};var _="SET_ADMIN",S={isAdmin:!1};var L={color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(N.a)(Object(N.a)({},e),{},{colors:t.payload});case h:return Object(N.a)(Object(N.a)({},e),{},{isLoading:t.payload});case p:return Object(N.a)(Object(N.a)({},e),{},{error:t.payload,isLoading:!1});case f:return Object(N.a)(Object(N.a)({},e),{},{colors:[].concat(Object(C.a)(e.colors),[Object(N.a)(Object(N.a)({},t.payload),{},{id:Date.now()})])});case v:var n=t.payload,r=n.id,c=n.name,a=n.description,o=n.color,i=n.rate,s=e.colors.map((function(e){if(e.id===r){var t=e.rating||[];return t=i?[].concat(Object(C.a)(t),[i]):t,Object(N.a)(Object(N.a)({},e),{},{name:c,description:a,color:o,rating:t})}return e}));return Object(N.a)(Object(N.a)({},e),{},{colors:s});case g:return Object(N.a)(Object(N.a)({},e),{},{colors:e.colors.filter((function(e){return e.id!==t.payload}))});case x:var l=t.payload,u=l.id,d=l.rate,j=e.colors.map((function(t){return t.id===u?Object(N.a)(Object(N.a)({},t),{},{rating:[].concat(Object(C.a)(e.colors.rating),[d])}):t}));return Object(N.a)(Object(N.a)({},e),{},{colors:j});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;return t.type===_?Object(N.a)(Object(N.a)({},e),{},{isAdmin:t.payload}):e}},k=Object(l.c)(L),A=Object(l.d)(k,Object(l.a)(u.a,y)),D=(n(103),n(104),n(6)),w=n(1),I=function(){return Object(w.jsx)("header",{className:"header",children:Object(w.jsx)("h1",{className:"header__title",children:Object(w.jsx)("a",{href:"/",className:"header__logo",children:"Colors Gallery"})})})},T=function(){return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{type:"checkbox",id:"nav-toggle",hidden:!0}),Object(w.jsxs)("nav",{className:"nav",children:[Object(w.jsx)("label",{htmlFor:"nav-toggle",className:"nav-toggle"}),Object(w.jsx)("h2",{children:"Menu"}),Object(w.jsxs)("ul",{children:[Object(w.jsx)("li",{children:Object(w.jsx)(s.c,{to:"/",activeClassName:"active",children:"Colors list"})}),Object(w.jsx)("li",{children:Object(w.jsx)(s.c,{to:"/add",activeClassName:"active",children:"Add color"})})]})]})]})},E=function(e){var t=e.children;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(I,{}),Object(w.jsxs)("div",{children:[Object(w.jsx)(T,{}),t]})]})},B=n(45),M=n(44),P=n(30),F=n.n(P),q=[{id:"1",name:"yellow",description:"",rating:[3,4,5]},{id:"2",name:"red",description:"",rating:[2,1,2]},{id:"3",name:"green",description:"",rating:[3,2,1]}],G=function(){function e(){Object(d.a)(this,e)}return Object(j.a)(e,null,[{key:"get",value:function(){var e=Object(M.a)(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout((function(){return e(q)}),200)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),J={setColors:function(e){return{type:m,payload:e}},setError:function(e){return{type:p,payload:e}},setIsLoading:function(e){return{type:h,payload:e}},addColor:function(e){return{type:f,payload:e}},editColor:function(e){return{type:v,payload:e}},removeColor:function(e){return{type:g,payload:e}},setRating:function(e){return{type:x,payload:e}},fetchColors:function(){return function(){var e=Object(M.a)(F.a.mark((function e(t){var n,r,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t(J.setIsLoading(!0)),r=b.get(),(c=null===r||void 0===r||null===(n=r.color)||void 0===n?void 0:n.colors)&&0!==c.length){e.next=9;break}return e.next=7,G.get();case 7:c=e.sent,console.log("colors not from kash",{colors:c});case 9:t(J.setColors(c)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t(J.setError(e.t0.message));case 15:return e.prev=15,t(J.setIsLoading(!1)),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}},H={setIsAdmin:function(e){return{type:_,payload:e}}},U=Object(N.a)(Object(N.a)({},J),H);var V=function(){var e=Object(i.b)();return Object(l.b)(U,e)},W=n(94),z=n(36),K=z.a().shape({name:z.b().min(5,"Too Short!").required("Required"),description:z.b().min(10,"Too Short!").max(300,"Too Long!"),color:z.b().required("Required")}),Q=function(){var e=Object(D.useHistory)(),t=V().addColor,n=Object(W.a)({initialValues:{name:"",description:"",color:""},validationSchema:K,onSubmit:function(e,n){t(e),n.resetForm()}});return Object(w.jsxs)("form",{className:"gallery-create gallery-create__container",onSubmit:n.handleSubmit,children:[Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Name:"}),Object(w.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:n.values.name,onChange:n.handleChange,onBlur:n.handleBlur})]}),n.touched.name&&n.errors.name?Object(w.jsx)("div",{className:"error",children:n.errors.name}):null,Object(w.jsxs)("div",{className:"form-line",children:[Object(w.jsx)("span",{children:"Description:"}),Object(w.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:n.values.description,onChange:n.handleChange,onBlur:n.handleBlur})]}),n.touched.description&&n.errors.description?Object(w.jsx)("div",{className:"error",children:n.errors.description}):null,Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Choose color:"}),Object(w.jsx)("input",{type:"color",name:"color",className:"form-input",value:n.values.color,onChange:n.handleChange,onBlur:n.handleBlur})]}),n.touched.color&&n.errors.color?Object(w.jsx)("div",{className:"error",children:n.errors.color}):null,Object(w.jsxs)("div",{className:"items__actions",children:[Object(w.jsx)("button",{type:"submit",children:"Add"}),Object(w.jsx)("button",{type:"button",onClick:function(t){e.push(he.COLORS)},children:"Close"})]})]})},X=n(28),Y=n(31);function Z(e){var t=null===e||void 0===e?void 0:e.length,n=0;return t&&(n=Math.round(e.reduce((function(e,t){return e+t}))/t)),n}function $(e){return new Array(e).fill(0).map((function(e,t){return t+1})).reverse()}var ee=function(e){return e.color.colors},te=Object(Y.a)([ee],(function(e){return e.reduce((function(e,t){return Object(N.a)(Object(N.a)({},e),{},Object(X.a)({},t.id,t))}),{})})),ne=Object(Y.a)([te,function(e,t){return t}],(function(e,t){return e[t]})),re=(Object(Y.a)(ee,(function(e){return e.map((function(e){var t=Z(null===e||void 0===e?void 0:e.rating);return Object(N.a)(Object(N.a)({},e),{},{averageRating:t})}))})),Object(Y.a)(ee,(function(e){return e.map((function(e){return e.id}))}))),ce=Object(Y.a)(ne,(function(e){console.log("selectColorWithAverageRatingById",{color:e});var t=Z(null===e||void 0===e?void 0:e.rating);return Object(N.a)(Object(N.a)({},e),{},{averageRating:t})})),ae=function(e){var t=e.id,n=e.value,r=e.disabled,c=e.averageRating,a=e.onChange,o="star-".concat(t,"-").concat(n),i="rating".concat(t),s="Rating \xab".concat(n,"\xbb");return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{type:"radio",id:o,name:i,value:n,onChange:function(){a(n)},disabled:r,checked:c===n}),Object(w.jsx)("label",{htmlFor:o,title:s})]})};ae.defaultProps={disabled:!1,onChange:function(){}};var oe=ae,ie=n(49),se=n.n(ie),le=function(e){var t=e.className,n=e.averageRating,r=e.children,a=c.a.Children.count(r),o="".concat(n," of ").concat(a," stars");return Object(w.jsxs)("div",{className:"item__rating",children:[Object(w.jsx)("div",{className:se()(t,"stars"),children:r}),Object(w.jsx)("div",{className:"items__stars-value",children:o})]})},ue=function(e){var t=e.id,n=Object(i.c)((function(e){return e.user.isAdmin})),r=Object(i.c)((function(e){return ce(e,t)})),c=r.color,a=r.name,o=r.averageRating,s=Object(B.useHistory)();return Object(w.jsxs)("div",{className:"gallery__item item",onClick:function(e){e.stopPropagation(),n?s.push("/color/".concat(t,"?role=admin")):s.push("/color/".concat(t))},children:[Object(w.jsx)("div",{className:"item__name","data-name":a,style:{color:c},children:a}),Object(w.jsx)("div",{className:"item__color-block",style:{background:c}}),Object(w.jsx)(le,{className:"item__stars",averageRating:o,onClick:function(e){e.stopPropagation()},children:$(5).map((function(e){return Object(w.jsx)(oe,{value:e,disabled:!0,averageRating:o,id:t},e)}))})]})},de=function(){var e=V().setIsAdmin,t=Object(i.c)((function(e){return e.user.isAdmin})),n=Object(i.c)(re);return Object(w.jsx)("main",{role:"main",children:Object(w.jsxs)("section",{className:"gallery",children:[Object(w.jsx)("header",{className:"gallery__header",children:Object(w.jsx)("h2",{children:"Colors list"})}),Object(w.jsx)("button",{onClick:function(){e(!t)},style:{marginRight:"auto",marginBottom:"20px"},children:t?"Try User":"Try Admin"}),Object(w.jsx)("div",{className:"gallery__row",children:n.map((function(e){return Object(w.jsx)(ue,{id:e},e)}))})]})})},je=function(){return Object(w.jsxs)("section",{className:"error-page",children:[Object(w.jsx)("h2",{children:"Unknown page"}),Object(w.jsx)(s.b,{to:"/",children:"Go to the main page"})]})},Oe=n(22),be={name:"",description:"",color:"",rate:""},me=function(){var e="admin"===function(){var e=Object(B.useLocation)().search;return Object(r.useMemo)((function(){return new URLSearchParams(e)}),[e])}().get("role"),t=Object(D.useParams)().id,n=Object(i.c)((function(e){return ce(e,t)})),c=Object(r.useState)(Object(N.a)(Object(N.a)({},be),n)),a=Object(Oe.a)(c,2),o=a[0],s=a[1],l=Object(D.useHistory)(),u=V(),d=u.editColor,j=u.removeColor,O=(u.setRating,function(e){var t=e.target,n=t.name,r=t.value;s((function(e){return Object(N.a)(Object(N.a)({},e),{},Object(X.a)({},n,r))}))}),b=function(e){s((function(t){return Object(N.a)(Object(N.a)({},t),{},{rate:e})}))};return Object(w.jsxs)("form",{className:"gallery-create gallery-create__container",onSubmit:function(e){e.preventDefault(),d(o)},children:[Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Name:"}),Object(w.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:o.name,onChange:O})]}),Object(w.jsxs)("div",{className:"form-line",children:[Object(w.jsx)("span",{children:"Description:"}),Object(w.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:o.description,onChange:O})]}),Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Choose color:"}),Object(w.jsx)("input",{type:"color",name:"color",className:"form-input",value:o.color,onChange:O})]}),Object(w.jsx)(le,{className:"item__stars",averageRating:o.averageRating,onClick:function(e){e.stopPropagation()},children:$(5).map((function(n){return Object(w.jsx)(oe,{value:n,averageRating:e?o.averageRating:o.rate,onChange:b,disabled:e,id:t},n)}))}),Object(w.jsxs)("div",{className:"items__actions",children:[Object(w.jsx)("button",{type:"submit",children:"Save"}),Object(w.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),window.confirm("The color will be removed. Continue ?")&&j(t),l.push(he.COLORS)},className:se()({hidden:!e}),children:"Delete"}),Object(w.jsx)("button",{type:"button",onClick:function(e){l.push(he.COLORS)},children:"Close"})]})]})},he={COLORADMIN:"/color/:id?role=admin",COLOR:"/color/:id",COLORS:"/",ADDCOLOR:"/add"},pe=function(){return Object(w.jsx)(E,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(me,{})})})},fe=[{id:he.COLORS,path:he.COLORS,render:function(){return Object(w.jsx)(E,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(de,{})})})},exact:!0},{id:he.COLOR,path:he.COLOR,render:pe,exact:!0},{id:he.COLORADMIN,path:he.COLORADMIN,render:pe,exact:!0},{id:he.ADDCOLOR,path:he.ADDCOLOR,render:function(){return Object(w.jsx)(E,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(Q,{})})})},exact:!0},{id:"/error",render:function(){return Object(w.jsx)(E,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(je,{})})})},exact:!0}],ve=function(){return Object(w.jsxs)(D.Switch,{children:[fe.map((function(e){return Object(r.createElement)(D.Route,Object(N.a)(Object(N.a)({},e),{},{key:e.id}))})),Object(w.jsx)(D.Redirect,{to:he.COLORS})]})};var ge=function(){return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(ve,{})})};A.dispatch(U.fetchColors()),o.a.render(Object(w.jsx)(i.a,{store:A,children:Object(w.jsx)(s.a,{children:Object(w.jsx)(ge,{})})}),document.getElementById("root"))}},[[206,1,2]]]);
//# sourceMappingURL=main.c85a5b91.chunk.js.map