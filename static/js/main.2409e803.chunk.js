(this.webpackJsonptemplate_redux_js=this.webpackJsonptemplate_redux_js||[]).push([[0],{43:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(19),o=n.n(a),i=n(9),s=n(10),l=n(13),u=n(32),j=n(20),d=n(21),O="galleryState",b=function(){function e(){Object(j.a)(this,e)}return Object(d.a)(e,null,[{key:"get",value:function(){return JSON.parse(sessionStorage.getItem(O))}},{key:"set",value:function(e){sessionStorage.setItem(O,JSON.stringify(e))}}]),e}(),m="SET_COLORS",h="SET_ISLOADING",p="SET_ERROR",f="ADD_COLOR",v="EDIT_COLOR",g="REMOVE_COLOR",x="SET_RATING",y=function(e){var t=e.getState;return function(e){return function(n){var c=e(n);return[m,p,h].includes(n.type)||b.set(t()),c}}},C=n(27),N=n(2),R={colors:[],isLoading:!1,error:""};var _="SET_ADMIN",L={isAdmin:!1};var S={color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(N.a)(Object(N.a)({},e),{},{colors:t.payload});case h:return Object(N.a)(Object(N.a)({},e),{},{isLoading:t.payload});case p:return Object(N.a)(Object(N.a)({},e),{},{error:t.payload,isLoading:!1});case f:return Object(N.a)(Object(N.a)({},e),{},{colors:[].concat(Object(C.a)(e.colors),[Object(N.a)(Object(N.a)({},t.payload),{},{id:Date.now()})])});case v:var n=t.payload,c=n.id,r=n.name,a=n.description,o=n.color,i=n.rate,s=e.colors.map((function(e){if(e.id===c){var t=e.rating||[];return t=i?[].concat(Object(C.a)(t),[i]):t,Object(N.a)(Object(N.a)({},e),{},{name:r,description:a,color:o,rating:t})}return e}));return Object(N.a)(Object(N.a)({},e),{},{colors:s});case g:return Object(N.a)(Object(N.a)({},e),{},{colors:e.colors.filter((function(e){return e.id!==t.payload}))});case x:var l=t.payload,u=l.id,j=l.rate,d=e.colors.map((function(t){return t.id===u?Object(N.a)(Object(N.a)({},t),{},{rating:[].concat(Object(C.a)(e.colors.rating),[j])}):t}));return Object(N.a)(Object(N.a)({},e),{},{colors:d});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;return t.type===_?Object(N.a)(Object(N.a)({},e),{},{isAdmin:t.payload}):e}},k=Object(l.c)(S),D=Object(l.d)(k,Object(l.a)(u.a,y)),A=(n(42),n(43),n(4)),w=n(0),I=function(){return Object(w.jsx)("header",{className:"header",children:Object(w.jsx)("h1",{className:"header__title",children:Object(w.jsx)("a",{href:"/",className:"header__logo",children:"Colors Gallery"})})})},E=function(){return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{type:"checkbox",id:"nav-toggle",hidden:!0}),Object(w.jsxs)("nav",{className:"nav",children:[Object(w.jsx)("label",{htmlFor:"nav-toggle",className:"nav-toggle"}),Object(w.jsx)("h2",{children:"Menu"}),Object(w.jsxs)("ul",{children:[Object(w.jsx)("li",{children:Object(w.jsx)(s.c,{to:"/",activeClassName:"active",children:"Colors list"})}),Object(w.jsx)("li",{children:Object(w.jsx)(s.c,{to:"/add",activeClassName:"active",children:"Add color"})})]})]})]})},T=function(e){var t=e.children;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(I,{}),Object(w.jsxs)("div",{children:[Object(w.jsx)(E,{}),t]})]})},M=n(11),P=n(26),F=n(24),G=n(23),J=n(14),B=n.n(J),H=[{id:"1",name:"yellow",description:"",rating:[3,4,5]},{id:"2",name:"red",description:"",rating:[2,1,2]},{id:"3",name:"green",description:"",rating:[3,2,1]}],U=function(){function e(){Object(j.a)(this,e)}return Object(d.a)(e,null,[{key:"get",value:function(){var e=Object(G.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout((function(){return e(H)}),200)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),V={setColors:function(e){return{type:m,payload:e}},setError:function(e){return{type:p,payload:e}},setIsLoading:function(e){return{type:h,payload:e}},addColor:function(e){return{type:f,payload:e}},editColor:function(e){return{type:v,payload:e}},removeColor:function(e){return{type:g,payload:e}},setRating:function(e){return{type:x,payload:e}},fetchColors:function(){return function(){var e=Object(G.a)(B.a.mark((function e(t){var n,c,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t(V.setIsLoading(!0)),c=b.get(),(r=null===c||void 0===c||null===(n=c.color)||void 0===n?void 0:n.colors)&&0!==r.length){e.next=9;break}return e.next=7,U.get();case 7:r=e.sent,console.log("colors not from kash",{colors:r});case 9:t(V.setColors(r)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),t(V.setError(e.t0.message));case 15:return e.prev=15,t(V.setIsLoading(!1)),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}},W={setIsAdmin:function(e){return{type:_,payload:e}}},q=Object(N.a)(Object(N.a)({},V),W);var z=function(){var e=Object(i.b)();return Object(l.b)(q,e)},K={name:"",description:"",color:""},Q=function(){var e=Object(c.useState)(K),t=Object(P.a)(e,2),n=t[0],r=t[1],a=Object(A.useHistory)(),o=z().addColor,i=function(e){var t=e.target,n=t.name,c=t.value;r((function(e){return Object(N.a)(Object(N.a)({},e),{},Object(M.a)({},n,c))}))};return Object(w.jsxs)("form",{className:"gallery-create gallery-create__container",onSubmit:function(e){e.preventDefault(),o(n),r(K)},children:[Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Name:"}),Object(w.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:n.name,onChange:i})]}),Object(w.jsxs)("div",{className:"form-line",children:[Object(w.jsx)("span",{children:"Description:"}),Object(w.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:n.description,onChange:i})]}),Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Choose color:"}),Object(w.jsx)("input",{type:"color",name:"color",className:"form-input",value:n.color,onChange:i})]}),Object(w.jsxs)("div",{className:"items__actions",children:[Object(w.jsx)("button",{type:"submit",children:"Add"}),Object(w.jsx)("button",{type:"button",onClick:function(e){a.push(be.COLORS)},children:"Close"})]})]})},X=n(15);function Y(e){var t=null===e||void 0===e?void 0:e.length,n=0;return t&&(n=Math.round(e.reduce((function(e,t){return e+t}))/t)),n}function Z(e){return new Array(e).fill(0).map((function(e,t){return t+1})).reverse()}var $=function(e){return e.color.colors},ee=Object(X.a)([$],(function(e){return e.reduce((function(e,t){return Object(N.a)(Object(N.a)({},e),{},Object(M.a)({},t.id,t))}),{})})),te=Object(X.a)([ee,function(e,t){return t}],(function(e,t){return e[t]})),ne=(Object(X.a)($,(function(e){return e.map((function(e){var t=Y(null===e||void 0===e?void 0:e.rating);return Object(N.a)(Object(N.a)({},e),{},{averageRating:t})}))})),Object(X.a)($,(function(e){return e.map((function(e){return e.id}))}))),ce=Object(X.a)(te,(function(e){console.log("selectColorWithAverageRatingById",{color:e});var t=Y(null===e||void 0===e?void 0:e.rating);return Object(N.a)(Object(N.a)({},e),{},{averageRating:t})})),re=function(e){var t=e.id,n=e.value,c=e.disabled,r=e.averageRating,a=e.onChange,o="star-".concat(t,"-").concat(n),i="rating".concat(t),s="Rating \xab".concat(n,"\xbb");return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("input",{type:"radio",id:o,name:i,value:n,onChange:function(){a(n)},disabled:c,checked:r===n}),Object(w.jsx)("label",{htmlFor:o,title:s})]})};re.defaultProps={disabled:!1,onChange:function(){}};var ae=re,oe=n(25),ie=n.n(oe),se=function(e){var t=e.className,n=e.averageRating,c=e.children,a=r.a.Children.count(c),o="".concat(n," of ").concat(a," stars");return Object(w.jsxs)("div",{className:"item__rating",children:[Object(w.jsx)("div",{className:ie()(t,"stars"),children:c}),Object(w.jsx)("div",{className:"items__stars-value",children:o})]})},le=function(e){var t=e.id,n=Object(i.c)((function(e){return e.user.isAdmin})),c=Object(i.c)((function(e){return ce(e,t)})),r=c.color,a=c.name,o=c.averageRating,s=Object(F.useHistory)();return Object(w.jsxs)("div",{className:"gallery__item item",onClick:function(e){e.stopPropagation(),n?s.push("/color/".concat(t,"?role=admin")):s.push("/color/".concat(t))},children:[Object(w.jsx)("div",{className:"item__name","data-name":a,style:{color:r},children:a}),Object(w.jsx)("div",{className:"item__color-block",style:{background:r}}),Object(w.jsx)(se,{className:"item__stars",averageRating:o,onClick:function(e){e.stopPropagation()},children:Z(5).map((function(e){return Object(w.jsx)(ae,{value:e,disabled:!0,averageRating:o,id:t},e)}))})]})},ue=function(){var e=z().setIsAdmin,t=Object(i.c)((function(e){return e.user.isAdmin})),n=Object(i.c)(ne);return Object(w.jsx)("main",{role:"main",children:Object(w.jsxs)("section",{className:"gallery",children:[Object(w.jsx)("header",{className:"gallery__header",children:Object(w.jsx)("h2",{children:"Colors list"})}),Object(w.jsx)("button",{onClick:function(){e(!t)},style:{marginRight:"auto",marginBottom:"20px"},children:t?"Try User":"Try Admin"}),Object(w.jsx)("div",{className:"gallery__row",children:n.map((function(e){return Object(w.jsx)(le,{id:e},e)}))})]})})},je=function(){return Object(w.jsxs)("section",{className:"error-page",children:[Object(w.jsx)("h2",{children:"Unknown page"}),Object(w.jsx)(s.b,{to:"/",children:"Go to the main page"})]})},de={name:"",description:"",color:"",rate:""},Oe=function(){var e="admin"===function(){var e=Object(F.useLocation)().search;return Object(c.useMemo)((function(){return new URLSearchParams(e)}),[e])}().get("role"),t=Object(A.useParams)().id,n=Object(i.c)((function(e){return ce(e,t)})),r=Object(c.useState)(Object(N.a)(Object(N.a)({},de),n)),a=Object(P.a)(r,2),o=a[0],s=a[1],l=Object(A.useHistory)(),u=z(),j=u.editColor,d=u.removeColor,O=(u.setRating,function(e){var t=e.target,n=t.name,c=t.value;s((function(e){return Object(N.a)(Object(N.a)({},e),{},Object(M.a)({},n,c))}))}),b=function(e){s((function(t){return Object(N.a)(Object(N.a)({},t),{},{rate:e})}))};return Object(w.jsxs)("form",{className:"gallery-create gallery-create__container",onSubmit:function(e){e.preventDefault(),j(o)},children:[Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Name:"}),Object(w.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Name",value:o.name,onChange:O})]}),Object(w.jsxs)("div",{className:"form-line",children:[Object(w.jsx)("span",{children:"Description:"}),Object(w.jsx)("textarea",{name:"description",className:"form-input",rows:"10",placeholder:"Description",value:o.description,onChange:O})]}),Object(w.jsxs)("label",{className:"form-line",children:[Object(w.jsx)("span",{children:"Choose color:"}),Object(w.jsx)("input",{type:"color",name:"color",className:"form-input",value:o.color,onChange:O})]}),Object(w.jsx)(se,{className:"item__stars",averageRating:o.averageRating,onClick:function(e){e.stopPropagation()},children:Z(5).map((function(n){return Object(w.jsx)(ae,{value:n,averageRating:e?o.averageRating:o.rate,onChange:b,disabled:e,id:t},n)}))}),Object(w.jsxs)("div",{className:"items__actions",children:[Object(w.jsx)("button",{type:"submit",children:"Save"}),Object(w.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),window.confirm("The color will be removed. Continue ?")&&d(t),l.push(be.COLORS)},className:ie()({hide:!e}),children:"Delete"}),Object(w.jsx)("button",{type:"button",onClick:function(e){l.push(be.COLORS)},children:"Close"})]})]})},be={COLORADMIN:"/color/:id?role=admin",COLOR:"/color/:id",COLORS:"/",ADDCOLOR:"/add"},me=function(){return Object(w.jsx)(T,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(Oe,{})})})},he=[{id:be.COLORS,path:be.COLORS,render:function(){return Object(w.jsx)(T,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(ue,{})})})},exact:!0},{id:be.COLOR,path:be.COLOR,render:me,exact:!0},{id:be.COLORADMIN,path:be.COLORADMIN,render:me,exact:!0},{id:be.ADDCOLOR,path:be.ADDCOLOR,render:function(){return Object(w.jsx)(T,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(Q,{})})})},exact:!0},{id:"/error",render:function(){return Object(w.jsx)(T,{children:Object(w.jsx)("div",{className:"content",children:Object(w.jsx)(je,{})})})},exact:!0}],pe=function(){return Object(w.jsxs)(A.Switch,{children:[he.map((function(e){return Object(c.createElement)(A.Route,Object(N.a)(Object(N.a)({},e),{},{key:e.id}))})),Object(w.jsx)(A.Redirect,{to:be.COLORS})]})};var fe=function(){return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(pe,{})})};D.dispatch(q.fetchColors()),o.a.render(Object(w.jsx)(i.a,{store:D,children:Object(w.jsx)(s.a,{children:Object(w.jsx)(fe,{})})}),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.2409e803.chunk.js.map